# 图片源码解读

## jpg文件源码解读

JPEG格式如下

| SOI Marker | Marker XX size=SSSS  | Marker YY size=TTTT  | SOS Marker size=UUUU | Image stream | EOI Marker |
| ---------- | -------------------- | -------------------- | -------------------- | ------------ | ---------- |
| FFD8       | FFXX	SSSS	DDDD...... | FFYY	TTTT	DDDD...... | FFDA	UUUU	DDDD....   | I I I I....  | FFD9       |

jpeg：段标识(FF)+段类型(1字节)+段长度(2字节)+数据块
## png文件源码解读
对于一个PNG文件来说，其文件头总是由位固定的字节来描述的，
HEX： `89 50 4E 47 0D 0A 1A 0A`

其中第一个字节0x89超出了ASCII字符的范围，这是为了避免某些软件将PNG文件当做文本文件来处理。文件中剩余的部分由3个以上的PNG的数据块（Chunk）按照特定的顺序组成，因此，一个标准的PNG文件结构应该如下：

| PNG文件标志             | PNG数据块 | ... | PNG数据块 | 图像结束数据IEND                    |
| ----------------------- | --------- | --- | --------- |--|
| 89 50 4E 47 0D 0A 1A 0A |        ...   |   ...  |...           | 00 00 00 00 49 45 4E 44 AE 42 60 82 |

png：段长度(4字节)+段类型/类型标志(4字节)+数据块+校验码(4字节)

如文件的结尾12个字符看起来总应该是这样的：
HEX： `00 00 00 00 49 45 4E 44 AE 42 60 82`
对应的ascii码值为 `IEND B ` 
不难明白，由于数据块结构的定义，IEND数据块的长度总是0（00 00 00 00，除非人为加入信息），数据标识总是IEND（49 45 4E 44），因此，CRC码也总是AE 42 60 82。

## 参考
[PNG文件解读(2):PNG格式文件结构与数据结构解读—解码PNG数据](https://zhuanlan.zhihu.com/p/397397536)